<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="fonts.css">
    <link rel="stylesheet" href="game-view.css">
    <link rel="stylesheet" href="global.css">

    <meta charset="UTF-8">
    <title>Game View</title>
</head>
<body>
<div id="top-bar"></div>
<a style="position:absolute; left:50%; top:50%" id="error"></a>
<div id="center">
    <div id="left-bar">
        <div id="rainbow"></div>
        <div id="map-box" class="side-box">
            <a class="box-title">~Map~</a>
            <a class="box-element">[Wall]</a>
        </div>
        <!--        <hr>-->
        <div id="entity-box" class="side-box">
            <a class="box-title">~Entities~</a>
        </div>
        <!--        <hr>-->
        <div id="item-box" class="side-box">
            <a class="box-title">~Items~</a>
            <a class="box-element selected">Gym</a>
        </div>
    </div>
    <div id="viewport">
        <div id="entity"></div>
    </div>
</div>
<div id="bottom-bar">
    <div id="dialogue">
        <a id="entity-title">Entity Title</a>
        <a id="message">Entity Message</a>
    </div>
    <div id="action-box">
        <a id="interact" class="logical-button" onclick="app.interact()">Interact</a>
        <a id="inspect" class="logical-button" onclick="app.inspect()">Inspect</a>
        <a id="attack" class="logical-button" onclick="app.attack()">Attack</a>
        <a id="speak" class="logical-button" onclick="createInputBox()">Speak</a>
    </div>
</div>
<form onsubmit="tryInput()" id="input-box" class="entry-box floating-box" style="display:none">
    <span>?:</span>
    <input id="input" placeholder="_________________" maxlength="17">
</form>
<script>
    console.log = i => {
        document.getElementById('error').innerText = i
    }
    window.onerror = e => {
        console.log(e);
        logger.log(e)
    }

    function updateBox(name, current, rooms, button) {
        let mapBox = document.getElementById(name)
        mapBox.querySelectorAll('.box-element').forEach(it => it.remove())
        for (let i of rooms) {
            let elem = document.createElement('a')
            elem.innerText = i[0];
            elem.classList.add('box-element')
            if (button) elem.classList.add('logical-button')
            elem.id = i[1];
            if (i[1] == current) elem.classList.add('selected')
            mapBox.append(elem)
        }
    }

    function tryInput() {
        document.getElementById('input-box').style.display = "none";
        app.input(document.getElementById('input').value)
    }

    function createInputBox() {
        if (document.getElementById('speak').style.display === "none") return
        let box = document.getElementById('input-box');
        box.style.display = "";
        let input = document.getElementById('input');
        input.focus()
        input.value = ""
    }

    document.updateBox = updateBox
    addEventListener('submit', ev => ev.preventDefault())
</script>
</body>
</html>